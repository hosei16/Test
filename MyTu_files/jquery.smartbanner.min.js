/*!
 * jQuery Smart Banner
 * Copyright (c) 2012 Arnold Daniels <arnold@jasny.net>
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * Based on 'jQuery Smart Web App Banner' by Kurt Zenisek @ kzeni.com
 */
!function(a,b,c){!function(a){"use strict";"function"==typeof define&&define.amd?define("jquery.smartbanner",["jquery"],a):"object"==typeof exports?a(require("jquery")):jQuery&&a(jQuery)}(function(d){function e(a){return a.toLowerCase().replace(/-(.)/g,function(a,b){return b.toUpperCase()})}function f(a,c,d){var e=new Date;e.setDate(e.getDate()+d),c=encodeURI(c)+("undefined"==typeof d?"":"; expires="+e.toUTCString()),b.cookie=a+"="+c+"; path=/;"}function g(a){var c,d,e,f=b.cookie.split(";");for(c=0;c<f.length;c++)if(d=f[c].substr(0,f[c].indexOf("=")),e=f[c].substr(f[c].indexOf("=")+1),d=d.replace(/^\s+|\s+$/g,""),d===a)return decodeURI(e);return null}/*!
     * Bootstrap transition
     * Copyright 2011-2014 Twitter, Inc.
     * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
     */
function h(){var a=b.createElement("smartbanner"),d={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var e in d)if(a.style[e]!==c)return{end:d[e]};return!1}var i=function(b){this.origHtmlMargin=parseFloat(d("html").css("margin-top")),b=d.extend({},d.smartbanner.defaults,b),this.os=b.force||this.detectOS(),!b.force&&(!this.os||this.hasNativeSupport()||!b.showInUIWebView&&this.isUIWebView()||g("sb-closed")||g("sb-installed"))||(this.options=d.extend(b,this.getMeta(),b[this.os]),this.options.appId&&(this.scale="auto"===this.options.scale?d(a).width()/a.screen.width:this.options.scale,this.scale<1&&(this.scale=1),this.options.title||(this.options.title=d("title").text().replace(/\s*[|\-Â·].*$/,"")),this.options.author||(this.options.author=d('meta[name="author"]').length?d('meta[name="author"]').attr("content"):a.location.hostname),this.create(),this.listen(),this.show()))};i.prototype.constructor=i,i.prototype.detectOS=function(){var a=navigator.userAgent;return a.match(/iPhone|iPod/i)||a.match(/iPad/i)&&this.options.iOSUniversalApp?"ios":a.match(/\bSilk\/(.*\bMobile Safari\b)?/)||a.match(/\bKF\w/)||a.match("Kindle Fire")?"kindle":a.match(/Android/i)?"android":a.match(/Windows Phone 8.0|Windows Phone OS|XBLWP7|ZuneWP7/i)?"windows":null},i.prototype.hasNativeSupport=function(){var a=navigator.userAgent;return a.match(/iPhone|iPod|iPad/i)&&a.match(/Safari/i)&&!a.match(/CriOS/i)&&Number(a.substr(a.indexOf("OS ")+3,3).replace("_","."))>=6},i.prototype.isUIWebView=function(){var a=navigator.userAgent;return navigator.standalone||a.match(/iPhone|iPod|iPad/i)&&!a.match(/Safari/i)},i.prototype.getMeta=function(){var a,b,c,f=/([\w-]+)=([^,]+)/gi,g={};switch(this.os){case"ios":a='meta[name="apple-itunes-app"]';break;case"android":a='meta[name="google-play-app"]';break;case"kindle":a='meta[name="kindle-fire-app"]';break;case"windows":return this.getWindowsMeta()}for(b=d(a).attr("content");c=f.exec(b);)g[e(c[1])]=c[2];return d.extend(g,d(a).data()),g},i.prototype.getWindowsMeta=function(){var a={};return a.appId=d('meta[name="msApplication-ID"]').attr("content"),a.appPfn=d('meta[name="msApplication-PackageFamilyName"]').attr("content"),d.extend(a,d('meta[name="msApplication-ID"]').data()),a},i.prototype.getUrl=function(){if(this.options.url)return this.options.url;switch(this.os){case"ios":return"itmss://itunes.apple.com/"+this.options.language+"/app/id"+this.appId;case"android":return"market://details?id="+this.options.appId;case"kindle":return"amzn://apps/android?asin="+this.options.appId;case"windows":return"ms-windows-store:PDP?PFN="+this.options.appPfn}},i.prototype.getIconUrl=function(){var a;if(this.options.icon)return this.options.icon;switch(this.os){case"android":case"kindle":a=d('link[rel="shortcut icon"][sizes="128x128"]').attr("href");case"ios":a||(a=d('link[rel="apple-touch-icon-precomposed"]').attr("href")),a||(a=d('link[rel="apple-touch-icon"]').attr("href"));break;case"windows":a=d('meta[name="msApplication-TileImage"], meta[name="msapplication-TileImage"]').att("content")}return a},i.prototype.getIconGloss=function(){return null!==this.options.iconGloss?this.options.iconGloss:"ios"===this.os&&d('link[rel="apple-touch-icon-precomposed"]').length>0},i.prototype.create=function(){var b=this.getIconUrl(),c=this.getUrl(),e=this.options.price?this.options.price+(this.options.priceText?" - "+this.options.priceText:""):"",f=d('<div id="smartbanner">').attr("class",this.os).append(d('<div class="sb-container">').append('<a href="#" class="sb-close">&times;</a>').append(d('<span class="sb-icon"></span>')).append(d('<div class="sb-info">').append(d("<strong>").text(this.options.title)).append(d("<span>").text(this.options.author)).append(d("<span>").text(e))).append(d('<a class="sb-button">').attr("href",c).append(d("<span>").text(this.options.button))));d("body").prepend(f),b?(d("#smartbanner .sb-icon").css("background-image","url("+b+")"),this.options.iconGloss&&d("#smartbanner .sb-icon").addClass("sb-gloss")):d("#smartbanner").addClass("no-icon"),this.bannerHeight=d("#smartbanner").outerHeight(),this.scale>1&&(d("#smartbanner").css("top",parseFloat(d("#smartbanner").css("top"))*this.scale).css("height",parseFloat(d("#smartbanner").css("height"))*this.scale).hide(),d("#smartbanner .sb-container").css("-webkit-transform","scale("+this.scale+")").css("-msie-transform","scale("+this.scale+")").css("-moz-transform","scale("+this.scale+")").css("width",d(a).width()/this.scale)),d("#smartbanner").css("position",this.options.layer?"absolute":"static")},i.prototype.listen=function(){d("#smartbanner .sb-close").on("click",d.proxy(this.close,this)),d("#smartbanner .sb-button").on("click",d.proxy(this.install,this))},i.prototype.show=function(){var a=d("#smartbanner"),b=this.origHtmlMargin+this.bannerHeight*this.scale,c=1e3*parseFloat(a.css("transition-duration"));a.stop(),d.support.transition?(a.one(d.support.transition.end,function(){a.addClass("shown")}).emulateTransitionEnd(c).css("top",0),d("body > section").addClass("sb-animation").one(d.support.transition.end,function(){d("body > section").removeClass("sb-animation")}).emulateTransitionEnd(c).css("margin-top",b)):(a.animate({top:0},{duration:c,easing:"swing"}).addClass("shown"),d("body > section").animate({marginTop:b},{duration:c,easing:"swing"}))},i.prototype.hide=function(){var a=d("#smartbanner"),b=-1*this.bannerHeight*this.scale,c=1e3*parseFloat(a.css("transition-duration"));a.stop(),d.support.transition?(a.one(d.support.transition.end,function(){d("#smartbanner").remove()}).emulateTransitionEnd(c).removeClass("shown").css("top",b),d("body > section").addClass("sb-animation").one(d.support.transition.end,function(){d("body > section").css("margin-top","").removeClass("sb-animation")}).emulateTransitionEnd(c).css("margin-top",this.origHtmlMargin)):(a.animate({top:b},{duration:c,easing:"swing"}).addClass("shown"),d("body > section").animate({marginTop:this.origHtmlMargin},{duration:c,easing:"swing"}))},i.prototype.destroy=function(){d(b).one("hidden.smartbanner",d.proxy(function(){d("#smartbanner").remove(),d(a).removeData("smartbanner")},this)),this.hide()},i.prototype.close=function(a){a.preventDefault(),this.hide(),f("sb-closed","true",this.options.daysHidden)},i.prototype.install=function(){this.options.hideOnInstall&&this.hide(),f("sb-installed","true",this.options.daysReminder)},d.smartbanner=function(b){var c=d(a),e=c.data("smartbanner"),f="object"==typeof b&&b;if(e||c.data("smartbanner",e=new i(f)),"string"==typeof b)return e[b]},d.smartbanner.defaults={title:null,author:null,language:"us",url:null,icon:null,iconGloss:null,button:"VIEW",scale:"auto",daysHidden:15,daysReminder:90,hideOnInstall:!0,ios:{price:"FREE",priceText:"On the App Store",universalApp:!0},android:{price:"FREE",priceText:"In Google Play",params:null},kindle:{price:"FREE",priceText:"In the Amazon Appstore"},windows:{price:"FREE",priceText:"In the Windows Store"},force:null},d.smartbanner.Constructor=i,"undefined"==typeof d.support.transition&&(d.fn.emulateTransitionEnd=function(a){var b=!1,c=this;d(this).one(d.support.transition.end,function(){b=!0});var e=function(){b||d(c).trigger(d.support.transition.end)};return setTimeout(e,a),this},d.support.transition=h())})}(window,document);
//# sourceMappingURL=jquery.smartbanner.min.js.map