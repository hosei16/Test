!function(t,n,s){!function(t){"use strict";"function"==typeof define&&define.amd?define("jquery.smartbanner",["jquery"],t):"object"==typeof exports?t(require("jquery")):jQuery&&t(jQuery)}(function(e){function i(t){return t.toLowerCase().replace(/-(.)/g,function(t,n){return n.toUpperCase()})}function o(t,s,e){var i=new Date;i.setDate(i.getDate()+e),s=encodeURI(s)+(void 0===e?"":"; expires="+i.toUTCString()),n.cookie=t+"="+s+"; path=/;"}function a(t){var s,e,i,o=n.cookie.split(";");for(s=0;s<o.length;s++)if(e=o[s].substr(0,o[s].indexOf("=")),i=o[s].substr(o[s].indexOf("=")+1),(e=e.replace(/^\s+|\s+$/g,""))===t)return decodeURI(i);return null}var r=function(n){this.origHtmlMargin=parseFloat(e("html").css("margin-top")),n=e.extend({},e.smartbanner.defaults,n),this.os=n.force||this.detectOS(),!n.force&&(!this.os||this.hasNativeSupport()||!n.showInUIWebView&&this.isUIWebView()||a("sb-closed")||a("sb-installed"))||(this.options=e.extend(n,this.getMeta(),n[this.os]),this.options.appId&&(this.scale="auto"===this.options.scale?e(t).width()/t.screen.width:this.options.scale,this.scale<1&&(this.scale=1),this.options.title||(this.options.title=e("title").text().replace(/\s*[|\-Â·].*$/,"")),this.options.author||(this.options.author=e('meta[name="author"]').length?e('meta[name="author"]').attr("content"):t.location.hostname),this.create(),this.listen(),this.show()))};r.prototype.constructor=r,r.prototype.detectOS=function(){var t=navigator.userAgent;return t.match(/iPhone|iPod/i)||t.match(/iPad/i)&&this.options.iOSUniversalApp?"ios":t.match(/\bSilk\/(.*\bMobile Safari\b)?/)||t.match(/\bKF\w/)||t.match("Kindle Fire")?"kindle":t.match(/Android/i)?"android":t.match(/Windows Phone 8.0|Windows Phone OS|XBLWP7|ZuneWP7/i)?"windows":null},r.prototype.hasNativeSupport=function(){var t=navigator.userAgent;return t.match(/iPhone|iPod|iPad/i)&&t.match(/Safari/i)&&!t.match(/CriOS/i)&&Number(t.substr(t.indexOf("OS ")+3,3).replace("_","."))>=6},r.prototype.isUIWebView=function(){var t=navigator.userAgent;return navigator.standalone||t.match(/iPhone|iPod|iPad/i)&&!t.match(/Safari/i)},r.prototype.getMeta=function(){var t,n,s,o=/([\w-]+)=([^,]+)/gi,a={};switch(this.os){case"ios":t='meta[name="apple-itunes-app"]';break;case"android":t='meta[name="google-play-app"]';break;case"kindle":t='meta[name="kindle-fire-app"]';break;case"windows":return this.getWindowsMeta()}for(n=e(t).attr("content");s=o.exec(n);)a[i(s[1])]=s[2];return e.extend(a,e(t).data()),a},r.prototype.getWindowsMeta=function(){var t={};return t.appId=e('meta[name="msApplication-ID"]').attr("content"),t.appPfn=e('meta[name="msApplication-PackageFamilyName"]').attr("content"),e.extend(t,e('meta[name="msApplication-ID"]').data()),t},r.prototype.getUrl=function(){if(this.options.url)return this.options.url;switch(this.os){case"ios":return"itmss://itunes.apple.com/"+this.options.language+"/app/id"+this.appId;case"android":return"market://details?id="+this.options.appId;case"kindle":return"amzn://apps/android?asin="+this.options.appId;case"windows":return"ms-windows-store:PDP?PFN="+this.options.appPfn}},r.prototype.getIconUrl=function(){var t;if(this.options.icon)return this.options.icon;switch(this.os){case"android":case"kindle":t=e('link[rel="shortcut icon"][sizes="128x128"]').attr("href");case"ios":t||(t=e('link[rel="apple-touch-icon-precomposed"]').attr("href")),t||(t=e('link[rel="apple-touch-icon"]').attr("href"));break;case"windows":t=e('meta[name="msApplication-TileImage"], meta[name="msapplication-TileImage"]').att("content")}return t},r.prototype.getIconGloss=function(){return null!==this.options.iconGloss?this.options.iconGloss:"ios"===this.os&&e('link[rel="apple-touch-icon-precomposed"]').length>0},r.prototype.create=function(){var n=this.getIconUrl(),s=this.getUrl(),i=this.options.price?this.options.price+(this.options.priceText?" - "+this.options.priceText:""):"",o=e('<div id="smartbanner">').attr("class",this.os).append(e('<div class="sb-container">').append('<a href="#" class="sb-close">&times;</a>').append(e('<span class="sb-icon"></span>')).append(e('<div class="sb-info">').append(e("<strong>").text(this.options.title)).append(e("<span>").text(this.options.author)).append(e("<span>").text(i))).append(e('<a class="sb-button">').attr("href",s).append(e("<span>").text(this.options.button))));e("body").prepend(o),n?(e("#smartbanner .sb-icon").css("background-image","url("+n+")"),this.options.iconGloss&&e("#smartbanner .sb-icon").addClass("sb-gloss")):e("#smartbanner").addClass("no-icon"),this.bannerHeight=e("#smartbanner").outerHeight(),this.scale>1&&(e("#smartbanner").css("top",parseFloat(e("#smartbanner").css("top"))*this.scale).css("height",parseFloat(e("#smartbanner").css("height"))*this.scale).hide(),e("#smartbanner .sb-container").css("-webkit-transform","scale("+this.scale+")").css("-msie-transform","scale("+this.scale+")").css("-moz-transform","scale("+this.scale+")").css("width",e(t).width()/this.scale)),e("#smartbanner").css("position",this.options.layer?"absolute":"static")},r.prototype.listen=function(){e("#smartbanner .sb-close").on("click",e.proxy(this.close,this)),e("#smartbanner .sb-button").on("click",e.proxy(this.install,this))},r.prototype.show=function(){var t=e("#smartbanner"),n=this.origHtmlMargin+this.bannerHeight*this.scale,s=1e3*parseFloat(t.css("transition-duration"));t.stop(),e.support.transition?(t.one(e.support.transition.end,function(){t.addClass("shown")}).emulateTransitionEnd(s).css("top",0),e("body > section").addClass("sb-animation").one(e.support.transition.end,function(){e("body > section").removeClass("sb-animation")}).emulateTransitionEnd(s).css("margin-top",n)):(t.animate({top:0},{duration:s,easing:"swing"}).addClass("shown"),e("body > section").animate({marginTop:n},{duration:s,easing:"swing"}))},r.prototype.hide=function(){var t=e("#smartbanner"),n=-1*this.bannerHeight*this.scale,s=1e3*parseFloat(t.css("transition-duration"));t.stop(),e.support.transition?(t.one(e.support.transition.end,function(){e("#smartbanner").remove()}).emulateTransitionEnd(s).removeClass("shown").css("top",n),e("body > section").addClass("sb-animation").one(e.support.transition.end,function(){e("body > section").css("margin-top","").removeClass("sb-animation")}).emulateTransitionEnd(s).css("margin-top",this.origHtmlMargin)):(t.animate({top:n},{duration:s,easing:"swing"}).addClass("shown"),e("body > section").animate({marginTop:this.origHtmlMargin},{duration:s,easing:"swing"}))},r.prototype.destroy=function(){e(n).one("hidden.smartbanner",e.proxy(function(){e("#smartbanner").remove(),e(t).removeData("smartbanner")},this)),this.hide()},r.prototype.close=function(t){t.preventDefault(),this.hide(),o("sb-closed","true",this.options.daysHidden)},r.prototype.install=function(){this.options.hideOnInstall&&this.hide(),o("sb-installed","true",this.options.daysReminder)},e.smartbanner=function(n){var s=e(t),i=s.data("smartbanner"),o="object"==typeof n&&n;if(i||s.data("smartbanner",i=new r(o)),"string"==typeof n)return i[n]},e.smartbanner.defaults={title:null,author:null,language:"us",url:null,icon:null,iconGloss:null,button:"VIEW",scale:"auto",daysHidden:15,daysReminder:90,hideOnInstall:!0,ios:{price:"FREE",priceText:"On the App Store",universalApp:!0},android:{price:"FREE",priceText:"In Google Play",params:null},kindle:{price:"FREE",priceText:"In the Amazon Appstore"},windows:{price:"FREE",priceText:"In the Windows Store"},force:null},e.smartbanner.Constructor=r,void 0===e.support.transition&&(e.fn.emulateTransitionEnd=function(t){var n=!1,s=this;e(this).one(e.support.transition.end,function(){n=!0});return setTimeout(function(){n||e(s).trigger(e.support.transition.end)},t),this},e.support.transition=function(){var t=n.createElement("smartbanner"),e={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var i in e)if(t.style[i]!==s)return{end:e[i]};return!1}())})}(window,document);
//# sourceMappingURL=jquery.smartbanner.min.js.map